# Making graphs in R {#graph}

**(AH: I worked here a bit. Need instructions to export figures)**

You might have had experience making graphs using `Microsoft Excel`, however, making graphs with `Excel` is not recommended. A number of reasons to choose `R` over `Excel` are given in Chapter \@ref(intro). In addition, the defaults in `Excel` do not meet standards for good scientific graphs and you do not have the option to learn more sophisticated graphs after you master the basics, as the range of options available in `Excel` is limited.

You can make very attractive, clean, professional graphs and figures in `R`. This chapter is a basic introduction to `plot()` functions in `R`. More advanced users can use the package `ggplot`. There are many good reference manuals for making sophisticated graphs (e.g., Murrell 2006; Mittal 2011). 

In `R`, `plot()` is a built-in function: you do not need to install a package to call it. There are two mandatory arguments `x` and `y` which are vectors that must have the same length. For example,

```{r}
x <- c(2,4,6,8,10)
y <- c(10,20,30,40,50)
```
Copy and paste the above code into your `Console` and type `Enter/Return`. Note that to make a vector we need to use `c()`. Now, query the value of `x` by typing `x` into your `Console`


```{r}
x
```

This lets us know that `x` is a vector that is a list of 5 numbers.

The command `plot(x,y)` will mark points on the graph by taking elements in the same position in the `x` and `y` vectors. For example, in the first position of the `x` and `y` vectors are `2` and `10`, respectively. Because `plot(x,y)` has `x` as its first argument, the values of `x` will correspond to the horizontal axis of the plot. Therefore, the first element of the lists `x` and `y`, will be reflected in the plot as a point marked at the `2` position of the horizontal axis and the `10` position on the vertical axis.

As the vectors `x` and `y` in our example are a list of 5 numbers our graph will consist of 5 points, generated by pairing values in the `x` and `y` vectors in the same position.

``` 
x <- c(2,4,6,8,10)
y <- c(10,20,30,40,50)
plot(x,y)
```

Will give a graph like this:

```{r scatterplot1, fig.cap="A poor example of a scatter plot", fig.align='center', out.width="70%", fig.show='hold', echo=FALSE}
knitr::include_graphics('./figures/Fig_7_1.jpeg')
```

Try it yourself by copy and pasting the above code into your `Console`. If `x` and `y` do not have the same lengths, the `plot()` function will give an error. Try the code below by copy and pasting it into your console:

``` 
x <- c(2)
y <- c(10,20,30,40,50)
plot(x,y)
```
Note the error message that is generated so that if you get this error later when coding on your own you might remember that this error is generated because `x` and `y` have different lengths.

Now try this code:

``` 
x <- c(2,2,2,2,2)
y <- c(10,20,30,40,50)
plot(x,y)
length(x)
length(y)
```
Note we can use `length()` to query the length of `x` and `y`. In addition, the names `x` and `y` are the users choice. A nearly identical plot is generated with the code:

``` 
A <- c(2,2,2,2,2)
B <- c(10,20,30,40,50)
plot(A,B)
```
The key is the internal consistency: `A` and `B` are the names of the vectors and these same names appear as the arguments of `plot(A,B)`. Can you guess what happens if you try `plot(B,A)` or `plot(A,A)`? Type these into your `Console` and give it a try.

Note that all of the Figures we have made so far are not great: none meet the standards of a good figure. What's missing?

- meaningful `x` and `y` axis labels, 
- maybe it's more appropriate to show this data connected with a line, and
- maybe you want the symbols to be a different shape or colour.

In addition, to the two manadatory arguments `x` and `y`, the `plot()` function has other optional argument that can be called to make a better figure. Try using the `help()` learn about more options to change the look of your plot (refer to Chapter \@ref(help), _Getting help in R_, to recall how to display and read help files):

```
help(plot)
```

You'll see there are a lot of optional arguments. First, let's fix the axis labels.

```{r}
x <- c(2,4,6,8,10)
y <- c(10,20,30,40,50)
plot(x,y, xlab = "temperature (degrees C)", ylab = "growth rate (cm)")
```

This one is a little better.

If you want to change the symbols, you use the `pch` argument to change the style (see Section X).

So, let's re-do the graph in Figure 7.1, but with filled triangles.

```plot(x,y, pch = 17, xlab = "temperature (degrees C)", ylab = "growth rate (cm)")```

And we get...

```{r scatterplot3, fig.cap="The same scatter plot as Figure 7.2, but with symbols as filled triangles", fig.align='center', out.width="70%", fig.show='hold', echo=FALSE}
knitr::include_graphics('./figures/Fig_7_3.jpg')
```

## Other useful plot functions

The generic `plot()` function makes a scatter plot, with variations. 

For other types of plots, R has different functions, but all have similar arguments for adjusting the labels, spacing, tic marks, symbols, etc. 

See the following

```barplot{graphics}``` to make bar graphs
```boxplot{graphics}``` to make boxplots
```hist{graphics}``` to make a histogram


## Getting a bit more sophisticated

It's not hard to get more sophisticate with R graphics. The best approach is to explore one of the reference books listed to figure out how to do what you want to do.

One thing most undergrads will probably need or want to do is to visualize two sets of data on the same graph. For example, the goldfish data in the Appendix of the BIOL 1001 lab manual shows the opercular beats of two fish in response to temperature. It would be logical to show both fish on the same graph, but with different symbols. Here's how you would do it:

```temp <- cbind(5, 8, 12, 16, 20, 23) #This creates the vecor of data for the x-axis
fishA <- cbind(36, 42, 59, 73, 88, 96) #This creates the vector of data for Fish A
fishB <- cbind(40, 49, 61, 71, 82, 90) #This creates the vector of data for Fish B

## First we plot x and y with the "temp" vector as "x" and the "fishA" vector as y 

plot(temp, fishA, pch = 17, xlab = "temperature (degrees C)", ylab = "opercular beats (bpm)")

## Then to add a second vector of data (fishB) to the same plot, we use:
points(temp, fishB, pch = 17, col = "dimgray")```


Voila!

```{r goldfishplot, fig.cap="The effect of water temperature on opercular beats per minute (bpm) for two goldfish; goldfish A (black triangles) and goldfish B (grey triangles)", fig.align='center', out.width="70%", fig.show='hold', echo=FALSE}
knitr::include_graphics('./figures/Fig_7_4.jpg')
```

Note that the difference in the two symbols is described in the caption. For most scientific journals it is preferred to describe the symbology in the caption, rather than use a legend. However, with more complex graphs, or for some publications, you may wish to include a legend. Legends can be a bit tricky to work with in R - we'll leave those for a more advanced course. 

## pch Cheatsheet
You can make a little cheat sheet for `pch` codes using this code. Print it out and tape it up on your wall by your computer, or in the front of your notebook as a handy reference.

```{r}
#++++++++++++++++++++++++++++++++++++++++++++
#generate a plot of point shapes which R knows about.
#++++++++++++++++++++++++++++++++++++++++++++
generateRPointShapes<-function(){
  oldPar<-par()
  par(font=2, mar=c(0.5,0,0,0))
  y=rev(c(rep(1,6),rep(2,5), rep(3,5), rep(4,5), rep(5,5)))
  x=c(rep(1:5,5),6)
  plot(x, y, pch = 0:25, cex=1.5, ylim=c(1,5.5), xlim=c(1,6.5), 
       axes=FALSE, xlab="", ylab="", bg="blue")
  text(x, y, labels=0:25, pos=3)
  par(mar=oldPar$mar,font=oldPar$font )
}
generateRPointShapes()
```
